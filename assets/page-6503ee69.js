import{_ as T,ae as w,u as C,x as I,v as f,o as h,l as B,i as n,k as D,af as L,ag as N,a,h as p,f as S,ah as v}from"./index-27ccc2fa.js";import{B as U}from"./index-7a8f1c08.js";import{C as $}from"./index-6d7c2e6a.js";import"./index-c2a0b9a2.js";/* empty css              */import{U as z}from"./index-92ed4a20.js";import{F,a as R}from"./index-e3205289.js";import{c as g,s as j,d as q,e as A}from"./function-call-172fd109.js";import"./index-853dd8a7.js";import"./use-id-6ce38f2e.js";const G={class:"action-button"},K={__name:"page",setup(O){const y=w(),_=C();let s=I({content:""});const t=f([]),l=f(!1),{areaKey:c,areaName:b,dataType:x}=y.query;async function V(){const r=D();if(!r.userInfo){g("请去我的页面进行登录或注册");return}if(!s.content&&!t.value.length){g("还没有填写内容或图片哦");return}if(l.value===!0)return;l.value=!0,j({message:"提交中...",duration:0,forbidClick:!0,loadingType:"spinner"});let e=[];const o=new Date;t.value.length&&(e=t.value.map(m=>`${c}_${+o}_${m.file.name}`));const u=o.toLocaleString().replaceAll("/","-"),d={content:s.content,images:e,datetime:u};await L("verify",{...d,datetime:u,nickname:r.userInfo.username,userid:r.userInfo.userid,areaKey:c,areaName:b,dataType:x}),N(c,t.value,+o),q(),A({message:"提交成功，审核后将会显示。",duration:1200}),setTimeout(()=>{_.go(-1),l.value=!1},1300)}return(r,e)=>{const o=F,u=z,d=$,m=U,k=R;return h(),B(k,{class:"commnet-form",onSubmit:V},{default:n(()=>[a(d,{inset:""},{default:n(()=>[a(o,{modelValue:p(s).content,"onUpdate:modelValue":e[0]||(e[0]=i=>p(s).content=i),style:{"margin-bottom":"10px"},label:"留言",rows:"2",autosize:"",type:"textarea",placeholder:"说点什么吧~"},null,8,["modelValue"]),a(o,{name:"uploader",label:"图片上传"},{input:n(()=>[a(u,{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=i=>t.value=i),multiple:"","max-count":9},null,8,["modelValue"])]),_:1})]),_:1}),S("div",G,[a(m,{block:"",size:"small",round:"",type:"success",onClick:e[2]||(e[2]=i=>p(_).go(-1))},{default:n(()=>[v(" 取消 ")]),_:1}),a(m,{block:"",size:"small",round:"",type:"primary","native-type":"submit",loading:l.value,"loading-text":"提交中..."},{default:n(()=>[v(" 提交 ")]),_:1},8,["loading"])])]),_:1})}}},ee=T(K,[["__scopeId","data-v-9efd6d1e"]]);export{ee as default};
